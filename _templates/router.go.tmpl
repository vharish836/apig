package router

import (
	"fmt"
	
	"{{ .ImportDir }}/controllers"

	"github.com/gin-contrib/static"
	"github.com/gin-gonic/gin"
)

func Initialize(r *gin.Engine, sfiles string) {
	if sfiles != "" {
		fmt.Printf("serving static files from %s\n", sfiles)
		r.Use(static.Serve("/", static.LocalFile(sfiles, true)))
	}
	r.GET("/endpoints", controllers.APIEndpoints)

	api := r.Group("{{ .Namespace }}")
	{
{{ range .Models }}
		api.GET("/{{ pluralize (toSnakeCase .Name) }}", controllers.Get{{ pluralize .Name }})
		api.GET("/{{ pluralize (toSnakeCase .Name) }}/:id", controllers.Get{{ .Name }})
		api.POST("/{{ pluralize (toSnakeCase .Name) }}", controllers.Create{{ .Name }})
		api.PUT("/{{ pluralize (toSnakeCase .Name) }}/:id", controllers.Update{{ .Name }})
		api.DELETE("/{{ pluralize (toSnakeCase .Name) }}/:id", controllers.Delete{{ .Name }})
{{ end }}
	}
}
